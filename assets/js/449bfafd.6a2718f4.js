"use strict";(self.webpackChunkwei=self.webpackChunkwei||[]).push([[5231],{6415:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var r,o,a=n(675),c=n(467),i=n(6540),s=(n(2303),n(4848)),u=(0,i.createContext)({dbInstances:{},getPouchDBAsync:(o=(0,c.A)((0,a.A)().mark((function e(){return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),isPouchDBRefReady:!1,getPouchDBsync:function(){return null},isExist:function(){return!1},importPouchDB:(r=(0,c.A)((0,a.A)().mark((function e(){return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}),l=n(2080),d=n(7859),f=n(8820),p=n(667),m=n(206),h=n(4671),v=n(8984);const x=function(e){var t=e.label,n=e.value,r=e.onClick,o=(0,i.useState)(n),a=o[0],c=o[1];return(0,s.jsx)(p.A,{label:t,value:a,onChange:function(e){c(e.target.value)},fullWidth:!0,margin:"normal",InputProps:{endAdornment:a&&(0,s.jsx)(m.A,{position:"end",children:(0,s.jsx)(h.A,{onClick:function(){a.trim()&&(r(a),c(""))},children:(0,s.jsx)(v.A,{})})})}})};var A,g=n(1690),w=n(7461),j=n(3258),y=n(9781),k=n(8587),b=function(){function e(){}return e.debounce=function(e,t){var n=null;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];n&&clearTimeout(n),n=setTimeout((function(){e.apply(void 0,o)}),t)}},e}();A=b,b.toSeconds=function(e,t){if(void 0===t&&(t=1),"number"==typeof e)return e;var n=e.match(/^\s*(\d+)\s*(\u79d2|\u5206\u949f|\u5c0f\u65f6|\u6beb\u79d2|s(ec(ond)?)?|m(in(ute)?)?|h(our)?|ms|millisecond)\s*$/i);if(!n)throw new Error("\u65e0\u6548\u7684\u65f6\u95f4\u683c\u5f0f");var r=parseInt(n[1],10);switch(n[2].toLowerCase().toLowerCase()){case"\u79d2":case"sec":case"s":case"second":return r*t;case"\u5206\u949f":case"min":case"m":case"minute":return 60*r*t;case"\u5c0f\u65f6":case"h":case"hour":return 60*r*60*t;case"\u6beb\u79d2":case"ms":case"millisecond":return r;default:throw new Error("\u65e0\u6548\u7684\u65f6\u95f4\u5355\u4f4d")}},b.toMillisecond=function(e){return A.toSeconds(e,1e3)},b.timer=function(e,t,n){return void 0===t&&(t=1e3),n&&e?setInterval(n,A.toMillisecond(t)):null},b.formatTime=function(e){var t,n="string"==typeof e?new Date(e):e,r=(new Date).getTime()-n.getTime(),o=6e4,a=36e5,c=24*a,i=365*c;if(r<o)t=Math.floor(r/1e3)+" \u79d2";else if(r<a)t=Math.floor(r/o)+" \u5206\u949f";else if(r<c)t=Math.floor(r/a)+" \u5c0f\u65f6";else if(r<3*c){t=Math.floor(r/c)+" \u5929 "+Math.floor(r%c/a)+" \u5c0f\u65f6\u524d"}else t=r<i?null==n?void 0:n.toLocaleDateString(void 0,{month:"long",day:"numeric"}):null==n?void 0:n.toLocaleDateString(void 0,{year:"numeric",month:"long"});return{localDate:n,displayDate:t}};var D=n(1848),S=["processed","children"],T=(0,D.Ay)((function(e){e.processed;var t=e.children,n=(0,k.A)(e,S);return(0,s.jsx)(d.A,Object.assign({},n,{children:t}))}))((function(e){e.theme;var t=e.processed;return Object.assign({},t&&{variant:"overline",opacity:.2})}));const C=function(e){var t=e.timestamp,n=e.label,r=(0,i.useState)((function(){return b.formatTime(t)})),o=r[0],a=r[1];return(0,i.useEffect)((function(){var e=o.localDate,n=(new Date).getTime()-e.getTime(),r=function(){return a(b.formatTime(t))},c=null;n<6e4?c=b.timer(t,"1\u79d2",r):n<36e5?c=b.timer(t,"1\u5206\u949f",r):n<864e5&&(c=b.timer(t,"1\u5c0f\u65f6",r));var i=b.debounce((function(){c&&clearInterval(c)}),1e3);return function(){i()}}),[t,o]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(T,{component:"span",variant:"overline",children:[n&&n+": ",o.displayDate]}),(0,s.jsxs)(d.A,{component:"span",variant:"overline",children:[n&&n+": ",o.displayDate]})]})};const B=function(e){var t=e.todo,n=e.onToggleComplete,r=e.onDelete,o=(0,i.useState)(!1),a=o[0],c=o[1],u=function(){return c(!0)},l=function(){return c(!1)};return(0,s.jsxs)(g.Ay,{divider:!0,onMouseEnter:u,onMouseLeave:l,onTouchStart:u,onTouchEnd:l,style:{borderBottom:a?"2px solid #1976d2":"none"},children:[(0,s.jsx)(w.A,{checked:t.completed,onChange:function(){return n(t._id)},disabled:t.completed}),(0,s.jsx)(j.A,{primary:t.title,secondary:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C,{timestamp:t.createdAt,"aria-label":"Created"}),!1]}),style:{textDecoration:t.completed?"line-through":"none"}}),a&&(0,s.jsx)(h.A,{edge:"end",onClick:function(){return r(t._id)},children:(0,s.jsx)(y.A,{})})]})};var E=n(5260),I=n(481),M=n(6025);n(1312);function P(e){var t=e.title,n=e.description,r=e.keywords,o=e.image,a=e.links,c=e.children,i=(0,I.s)(t),u=(0,M.hH)().withBaseUrl,l=o?u(o,{absolute:!0}):void 0,d=a?Array.isArray(a)?a:[a]:null;return(0,s.jsxs)(E.A,{children:[t&&(0,s.jsx)("title",{children:i}),t&&(0,s.jsx)("meta",{property:"og:title",content:i}),n&&(0,s.jsx)("meta",{name:"description",content:n}),n&&(0,s.jsx)("meta",{property:"og:description",content:n}),r&&(0,s.jsx)("meta",{name:"keywords",content:Array.isArray(r)?r.join(","):r}),l&&(0,s.jsx)("meta",{property:"og:image",content:l}),l&&(0,s.jsx)("meta",{name:"twitter:image",content:l}),d&&d.map((function(e,t){return(0,s.jsx)("link",{rel:(null==e?void 0:e.rel)||"stylesheet",href:e.href},t)})),c]})}const _=function(){var e=(0,i.useState)(null),t=e[0],n=e[1],r=(0,i.useState)(!1),o=r[0],p=r[1],m=(0,i.useState)([]),h=m[0],v=m[1],A=(0,i.useContext)(u),g=A.getPouchDBAsync,w=A.getPouchDBsync,j=A.isPouchDBRefReady;(0,i.useEffect)((function(){var e;o||(0,c.A)((0,a.A)().mark((function t(){return(0,a.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(j){t.next=8;break}return t.next=3,g("todos");case 3:e=t.sent,n(e),p(!0),t.next=9;break;case 8:j&&!o&&(e=w("todos"),n(e),p(!0));case 9:case"end":return t.stop()}}),t)})))()}),[j,o,g,w]),(0,i.useEffect)((function(){if(t){var e=function(){var e=(0,c.A)((0,a.A)().mark((function e(){var n;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.allDocs({include_docs:!0});case 3:(n=e.sent).rows.length>0&&v(n.rows.map((function(e){return e.doc}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to fetch todos:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}}),[o,t]);var y=function(){var e=(0,c.A)((0,a.A)().mark((function e(n){var r;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n.trim()){e.next=2;break}return e.abrupt("return");case 2:return r={_id:(new Date).toISOString(),title:n,completed:!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},e.prev=3,e.next=6,null==t?void 0:t.put(r);case 6:v((function(e){return[].concat(e,[r])})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Failed to add todo:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,c.A)((0,a.A)().mark((function e(n){var r,o;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=h.find((function(e){return e._id===n})))){e.next=12;break}return o=Object.assign({},r,{completed:!r.completed,updatedAt:(new Date).toISOString()}),e.prev=3,e.next=6,null==t?void 0:t.put(o);case 6:v((function(e){return e.map((function(e){return e._id===n?o:e}))})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Failed to update todo:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,c.A)((0,a.A)().mark((function e(n){var r;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=h.find((function(e){return e._id===n})))){e.next=11;break}return e.prev=2,e.next=5,null==t?void 0:t.remove(r);case 5:v((function(e){return e.filter((function(e){return e._id!==n}))})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("Failed to delete todo:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),D=h.sort((function(e,t){return e.completed===t.completed?new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime():e.completed?1:-1}));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L,{}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(d.A,{variant:"h4",gutterBottom:!0,children:"Todo List"}),(0,s.jsx)(x,{label:"Add a new todo",value:"",onClick:y}),(0,s.jsx)(f.A,{children:D.map((function(e){return(0,s.jsx)(B,{todo:e,onToggleComplete:k,onDelete:b},e._id)}))})]})]})};var L=function(){return(0,s.jsxs)(P,{children:[(0,s.jsx)("title",{children:"\u5f3a\u5927\u9ad8\u6548\u7684 Todo \u5217\u8868\u7ec4\u4ef6\ud83c\udf89"}),(0,s.jsx)("meta",{name:"description",content:"\u8fd9\u662f\u4e00\u6b3e\u57fa\u4e8e React \u6784\u5efa\u7684 TodoList \u7ec4\u4ef6\uff0c\u5de7\u5999\u8fd0\u7528 useState \u548c useEffect \u94a9\u5b50\u5b9e\u73b0\u72b6\u6001\u4e0e\u526f\u4f5c\u7528\u7ba1\u7406\u3002\u4e0e PouchDB \u6570\u636e\u5e93\u5b8c\u7f8e\u4ea4\u4e92\uff0c\u652f\u6301\u5f85\u529e\u4e8b\u9879\u7684\u5f02\u6b65/\u540c\u6b65\u83b7\u53d6\u3001\u6dfb\u52a0\u3001\u72b6\u6001\u5207\u6362\u53ca\u5220\u9664\uff0c\u5e76\u8fdb\u884c\u6392\u5e8f\u5c55\u793a\uff0c\u5e26\u6765\u6781\u81f4\u9ad8\u6548\u4e14\u76f4\u89c2\u7684\u7528\u6237\u4f53\u9a8c\uff01"}),(0,s.jsx)("meta",{name:"keywords",content:"TodoList, React, \u589e\u5220\u6539\u67e5, \u6570\u636e\u540c\u6b65, \u72b6\u6001\u7ba1\u7406"})]})}}}]);